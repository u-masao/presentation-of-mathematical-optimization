stages:
  generate_scenario:
    matrix:
      id: ${ids}
    cmd: >-
      poetry run python -m src.generate_scenario
      src/prompt.md
      data/interim/scenario-${item.id}.md
      --temperature=${temperature}
    deps:
    - src/generate_scenario.py
    - src/prompt.md
    outs:
    - data/interim/scenario-${item.id}.md
  convert_to_pdf:
    matrix:
      id: ${ids}
    cmd: >-
      mkdir -p build ; rm -f build/* ;
      cp src/style.css build/ ;
      cp data/interim/scenario-${item.id}.md build/temp.md ;
      docker run --rm -v ./build/:/home/marp/app marp-cli-ja marp
      temp.md -o temp.pdf --pdf --theme style.css;
      cp build/temp.pdf
      data/interim/scenario-${item.id}.pdf
    deps:
    - src/style.css
    - data/interim/scenario-${item.id}.md
    outs:
    - data/interim/scenario-${item.id}.pdf
